import{a as re,b as le,c as se,d as ce,e as me}from"./chunk-FFHL4AVC.js";import"./chunk-TK4RTEGY.js";import"./chunk-YULUHQQ2.js";import{b as ie,c as ne}from"./chunk-AWVXNJFH.js";import{a as ee,b as te}from"./chunk-TRZFYDYS.js";import"./chunk-GHKXOCA3.js";import"./chunk-5OX6GXQO.js";import"./chunk-GIJM4SEB.js";import"./chunk-CLT3ZDBR.js";import{a as ae,b as oe}from"./chunk-SZ5LTZRU.js";import"./chunk-LEUMVM4K.js";import"./chunk-W7TJHXMM.js";import{j as B,l as O}from"./chunk-EQMPRG6V.js";import"./chunk-36JN3LZY.js";import"./chunk-M763EXIE.js";import{b as Z,c as $}from"./chunk-MWNC3RUP.js";import{b as q,e as W,f as L,h as G,j as R,k as z,l as H,r as J,s as Y,t as K,x as Q}from"./chunk-ZPMKEMCQ.js";import"./chunk-QE2BREUU.js";import{a as U,b as X}from"./chunk-HDHPZNG5.js";import"./chunk-JPTHL2WT.js";import{ea as A}from"./chunk-VAG7FTYF.js";import{C as D,d as I,e as V,l as N,z as k}from"./chunk-FIATBDAH.js";import{$b as F,Ca as c,Gb as E,Lb as o,Mb as h,Na as y,Qb as M,Rb as j,Sa as T,Sb as w,U as _,V as f,Wb as b,Ya as u,ib as m,jb as e,kb as t,lb as p,pb as x,qb as C,sb as v,wb as g,xb as d}from"./chunk-XJSKPFVT.js";import{g as P}from"./chunk-OXVY4BEJ.js";var pe=()=>[5,10,20],de=()=>({label:"Con deducci\xF3n",value:1}),ue=()=>({label:"Vaucher",value:2}),_e=()=>({label:"Embajada",value:3}),fe=()=>({label:"Sin deducci\xF3n",value:4}),Se=()=>({label:"Hist\xF3rica",value:5}),ve=(n,l,i,a,r)=>[n,l,i,a,r];function ge(n,l){n&1&&(e(0,"div",30)(1,"div",31)(2,"div",32),p(3,"i",33),t(),e(4,"div")(5,"h5",34),o(6,"Solicitud de constancia"),t(),e(7,"small",35),o(8," B\xFAsqueda de personal para generar constancia v\xEDa Emelina "),t()()(),e(9,"div",36),p(10,"p-tag",37),e(11,"span",38),o(12," Modo temporal sin WhatsApp "),t()()())}function he(n,l){if(n&1){let i=v();e(0,"p-card",12),u(1,ge,13,0,"ng-template",13),e(2,"div",14),p(3,"i",15),e(4,"p",16),o(5," Esta opci\xF3n de solicitud de constancias se habilit\xF3 temporalmente mientras el asistente virtual "),e(6,"strong"),o(7,"Emelina"),t(),o(8," completa su proceso de legalizaci\xF3n con la compa\xF1\xEDa Meta para el uso oficial de WhatsApp. "),e(9,"strong"),o(10,"La solicitud ser\xE1 atendida normalmente por Emelina"),t(),o(11,", pero la respuesta se enviar\xE1 \xFAnicamente al correo electr\xF3nico registrado, "),e(12,"strong"),o(13,"sin notificaci\xF3n por WhatsApp"),t(),o(14,". "),t()(),e(15,"p-divider",17)(16,"span",18),p(17,"i",19),o(18," Buscar persona "),t()(),e(19,"form",20,0)(21,"div",21)(22,"span",22),p(23,"i",23),t(),e(24,"input",24,1),g("keypress",function(r){_(i);let s=E(20),S=d();return f(S.enter(r,s.value))}),t(),e(26,"button",25),g("click",function(){_(i);let r=E(20),s=d();return f(s.buscarPorNombre(r.value))}),t()()(),e(27,"div",26)(28,"span",27),o(29,"Ejemplos:"),t(),p(30,"p-chip",28)(31,"p-chip",29),t()()}}function be(n,l){if(n&1){let i=v();e(0,"div",44)(1,"div")(2,"h5",34),o(3,"Resultado de b\xFAsqueda"),t(),e(4,"small",35),o(5," Selecciona a la persona correcta para continuar con la constancia "),t()(),e(6,"button",45),g("click",function(){_(i);let r=d(2);return f(r.atras(1))}),t()()}}function xe(n,l){n&1&&(e(0,"tr")(1,"th",46),o(2,"Opci\xF3n"),t(),e(3,"th"),o(4,"Grado"),t(),e(5,"th"),o(6,"Identidad"),t(),e(7,"th"),o(8,"Nombre"),t(),e(9,"th"),o(10,"Apellido"),t(),e(11,"th"),o(12,"Estado"),t()())}function Ce(n,l){if(n&1){let i=v();e(0,"tr")(1,"td",47)(2,"button",48),g("click",function(){let r=_(i).$implicit,s=d(2);return f(s.seleccionarPersona(r))}),t()(),e(3,"td"),o(4),t(),e(5,"td")(6,"span",49),o(7),t()(),e(8,"td"),o(9),t(),e(10,"td"),o(11),t(),e(12,"td"),p(13,"p-tag",50),t()()}if(n&2){let i=l.$implicit;c(4),h(i.grado),c(3),h(i.identidad),c(2),h(i.nombre),c(2),h(i.apellido),c(2),m("value",i.activo===1?"Activo":"Baja")("severity",i.activo===1?"success":"secondary")}}function Ee(n,l){n&1&&(e(0,"tr")(1,"td",51),p(2,"i",52),o(3," No se encontraron resultados para la b\xFAsqueda. "),t()())}function Me(n,l){if(n&1&&(e(0,"p-card",39),u(1,be,7,0,"ng-template",13),e(2,"p-table",40),u(3,xe,13,0,"ng-template",41)(4,Ce,14,6,"ng-template",42)(5,Ee,4,0,"ng-template",43),t()()),n&2){let i=d();c(2),m("value",i.arregloPersonaNombre)("paginator",!0)("rows",10)("rowsPerPageOptions",b(5,pe))("showCurrentPageReport",!0)}}function je(n,l){if(n&1){let i=v();e(0,"div",44)(1,"div")(2,"h5",34),o(3,"Solicitud de constancia"),t(),e(4,"small",35),o(5," Confirma los datos y el tipo de constancia a emitir "),t()(),e(6,"button",45),g("click",function(){_(i);let r=d(2);return f(r.atras(2))}),t()()}}function we(n,l){n&1&&(x(0),e(1,"div",54)(2,"label",55),o(3,"Empresa"),t(),p(4,"input",66,4),t(),C())}function ye(n,l){n&1&&(x(0),e(1,"div",54)(2,"label",55),o(3,"Mes"),t(),p(4,"input",67,5),t(),C())}function Pe(n,l){if(n&1){let i=v();x(0),e(1,"div",54)(2,"label",55),o(3,"Tipo de objeto"),t(),e(4,"p-select",68,6),w("ngModelChange",function(r){_(i);let s=d(2);return j(s.objetoSeleccionado,r)||(s.objetoSeleccionado=r),f(r)}),t()(),C()}if(n&2){let i=d(2);c(4),M("ngModel",i.objetoSeleccionado),m("options",i.arregloObjeto)}}function Te(n,l){if(n&1){let i=v();x(0),e(1,"div",54)(2,"label",55),o(3,"A\xF1o"),t(),p(4,"input",69,7),t(),e(6,"div",54)(7,"label",55),o(8,"Empresa"),t(),e(9,"p-select",70,4),w("ngModelChange",function(r){_(i);let s=d(2);return j(s.empresaSeleccionada,r)||(s.empresaSeleccionada=r),f(r)}),t()(),C()}if(n&2){let i=d(2);c(9),M("ngModel",i.empresaSeleccionada),m("options",i.arregloEmpresa)}}function Fe(n,l){n&1&&(e(0,"div",76),p(1,"i",77),e(2,"span",78),o(3,"Correos registrados"),t()())}function Ie(n,l){if(n&1&&(e(0,"tr")(1,"td"),o(2),t()()),n&2){let i=l.$implicit;c(2),h(i.correo)}}function Ve(n,l){n&1&&(e(0,"tr")(1,"td",79),o(2,"Sin correo registrado"),t()())}function Ne(n,l){if(n&1&&(e(0,"div",71)(1,"p-card",72),u(2,Fe,4,0,"ng-template",13),e(3,"div",73)(4,"table",74)(5,"tbody"),u(6,Ie,3,1,"tr",75)(7,Ve,3,0,"tr",60),t()()()()()),n&2){let i=d(2);c(6),m("ngForOf",i.correos),c(),m("ngIf",i.correos.length===0)}}function ke(n,l){n&1&&(e(0,"div",76),p(1,"i",80),e(2,"span",78),o(3,"Tel\xE9fonos registrados"),t()())}function De(n,l){if(n&1&&(e(0,"tr")(1,"td"),o(2),t()()),n&2){let i=l.$implicit;c(2),h(i.numero)}}function Ae(n,l){n&1&&(e(0,"tr")(1,"td",79),o(2,"Sin n\xFAmero de celular"),t()())}function Be(n,l){if(n&1&&(e(0,"div",71)(1,"p-card",72),u(2,ke,4,0,"ng-template",13),e(3,"div",73)(4,"table",74)(5,"tbody"),u(6,De,3,1,"tr",75)(7,Ae,3,0,"tr",60),t()()()()()),n&2){let i=d(2);c(6),m("ngForOf",i.telefonos),c(),m("ngIf",i.telefonos.length===0)}}function Oe(n,l){if(n&1){let i=v();e(0,"p-card",39),u(1,je,7,0,"ng-template",13),e(2,"form",53,2)(4,"div",54)(5,"label",55),o(6,"DNI"),t(),e(7,"span",56),p(8,"i",57)(9,"input",58),t()(),e(10,"div",54)(11,"label",55),o(12,"Nombres"),t(),e(13,"span",56),p(14,"i",33)(15,"input",58),t()(),e(16,"div",54)(17,"label",55),o(18,"Tipo de constancia"),t(),e(19,"p-select",59,3),w("ngModelChange",function(r){_(i);let s=d();return j(s.tipoConstancia,r)||(s.tipoConstancia=r),f(r)}),t()(),u(21,we,6,0,"ng-container",60)(22,ye,6,0,"ng-container",60)(23,Pe,6,2,"ng-container",60)(24,Te,11,2,"ng-container",60),e(25,"div",61)(26,"button",62),g("click",function(){_(i);let r=E(3),s=d();return f(s.registrarconsanciadeCorreo(r))}),t()()(),e(27,"p-divider",63)(28,"span",18),p(29,"i",64),o(30," Datos de contacto registrados "),t()(),e(31,"div",53),u(32,Ne,8,2,"div",65)(33,Be,8,2,"div",65),t()()}if(n&2){let i=d();c(9),m("value",i.personaSeleccionada==null?null:i.personaSeleccionada.identidad),c(6),m("value",(i.personaSeleccionada==null?null:i.personaSeleccionada.nombre)+" "+(i.personaSeleccionada==null?null:i.personaSeleccionada.apellido)),c(4),M("ngModel",i.tipoConstancia),m("options",F(15,ve,b(10,de),b(11,ue),b(12,_e),b(13,fe),b(14,Se))),c(2),m("ngIf",i.tipoConstancia!==2&&i.tipoConstancia!==5),c(),m("ngIf",i.tipoConstancia===2),c(),m("ngIf",i.tipoConstancia===2||i.tipoConstancia===5),c(),m("ngIf",i.tipoConstancia===5),c(8),m("ngIf",i.correos),c(),m("ngIf",i.telefonos)}}var mt=(()=>{let l=class l{constructor(a,r){this._DatospersonalesService=a,this._ServiciosMensajesService=r,this.pantalla=1,this.arregloPersonaNombre=[],this.correos=[],this.telefonos=[],this.arregloObjeto=[],this.arregloEmpresa=[],this.tipoConstancia=null}ngOnInit(){this.usuarioLogin=JSON.parse(localStorage.getItem("user_login")).user,this.sacarObjetoGasto()}enter(a,r){if(a.keyCode===13){if(r.nombre.length===0)return this._ServiciosMensajesService.mensajeMalo("Rellene el campo");this.buscarPorNombre(r)}}atras(a){this.pantalla=a}buscarPorNombre(a){if(a.nombre.trim().length<=3)return this._ServiciosMensajesService.mensajeMalo("Rellene el campo, o escriba mas de 3 letras");let r={cadena:` and  nombre_id like "%${a.nombre}%"`};this._ServiciosMensajesService.show(),this.arregloPersonaNombre=[],this._DatospersonalesService.buscarPersonal_en_siapffa(r).subscribe({next:s=>{this._ServiciosMensajesService.hide(),s.error?this._ServiciosMensajesService.mensajeMalo(s.error):s.mensaje?this._ServiciosMensajesService.mensajeMalo(s.mensaje):(this.arregloPersonaNombre=s.resultado,this.pantalla=2)},error:()=>{this._ServiciosMensajesService.hide(),this._ServiciosMensajesService.mensajeerrorServer()}})}seleccionarPersona(a){this.personaSeleccionada=a,this._ServiciosMensajesService.show(),this._DatospersonalesService.sacarCorreoYtelefono({identidad:this.personaSeleccionada.identidad}).subscribe({next:r=>{this._ServiciosMensajesService.hide(),this.correos=r.correo,this.telefonos=r.numero,this.pantalla=3},error:()=>{this._ServiciosMensajesService.hide(),this._ServiciosMensajesService.mensajeerrorServer()}})}sacarObjetoGasto(){this._DatospersonalesService.sacarObjetoGasto().subscribe({next:a=>{if(a.error)return this._ServiciosMensajesService.mensajeMalo(a.error);if(a.mensaje)return this._ServiciosMensajesService.mensajeMalo(a.mensaje);this.arregloObjeto=a.resultado,this.sacarEmpresa()},error:()=>{this._ServiciosMensajesService.mensajeerrorServer()}})}sacarEmpresa(){this._ServiciosMensajesService.show(),this._DatospersonalesService.consultaEmpresa().subscribe({next:a=>{if(this._ServiciosMensajesService.hide(),a.error)return this._ServiciosMensajesService.mensajeMalo(a.error);if(a.mensaje)return this._ServiciosMensajesService.mensajeMalo(a.mensaje);this.arregloEmpresa=a.resultado},error:()=>{this._ServiciosMensajesService.hide(),this._ServiciosMensajesService.mensajeerrorServer()}})}registrarconsanciadeCorreo(a){return P(this,null,function*(){if(!(yield this._ServiciosMensajesService.mensajePregunta("Esta segur@ de registrar esta solicitud")))return;if(this.telefonos.length===0)return this._ServiciosMensajesService.mensajeMalo("Debe tener almenos un n\xFAmero de celular con whatsap registrado en el sistema SIAPFFAA");if(this.correos.length===0)return this._ServiciosMensajesService.mensajeMalo("Debe tener almenos un correo registrado en el sistema SIAPFFAA");let s={persona_solicitante:this.personaSeleccionada,usuario:this.usuarioLogin,empresa:a.value.empresa,tipo_constancia:this.tipoConstancia,idestado_whatssap:1,donde_solicito:"Correo",numero:"504"+this.telefonos[0].numero.replace("-",""),correo:this.correos[0].correo,vauche_mes:a.value.mes?a.value.mes:-1,objeto:a.value.objeto?a.value.objeto:-1,ano_historico:a.value.ano,fecha_inicio:a.value.ano?a.value.ano+"-01-01":a.value.mes+"-01",ue_pertenece:this.personaSeleccionada.ue_pertenece};console.log(s),this._ServiciosMensajesService.show(),this._DatospersonalesService.registrarconsanciadeCorreo(s).subscribe({next:S=>(console.log(S),this._ServiciosMensajesService.hide(),S.error?this._ServiciosMensajesService.mensajeMalo(S.error):S.mensaje?this._ServiciosMensajesService.mensajeMalo(S.mensaje):(this.pantalla=1,this._ServiciosMensajesService.mensajeBueno(S.resultado))),error:()=>{this._ServiciosMensajesService.hide(),this._ServiciosMensajesService.mensajeerrorServer()}})})}verificarPermiso(a){return this._DatospersonalesService.verificarPermisos(a)}};l.\u0275fac=function(r){return new(r||l)(y(D),y(k))},l.\u0275cmp=T({type:l,selectors:[["app-solicitud-constancias-planffaa"]],decls:5,vars:3,consts:[["formbuscar","ngForm"],["nombre","ngModel"],["formRegistrar","ngForm"],["tipo","ngModel"],["empresa","ngModel"],["mes","ngModel"],["objeto","ngModel"],["ano","ngModel"],[1,"constancia-layout","py-3","py-md-4"],[1,"container-xl"],["class","buscador-persona shadow-3 border-0 rounded-4 overflow-hidden modern-card",4,"ngIf"],["class","buscador-persona shadow-3 border-0 rounded-4 overflow-hidden modern-card mt-3",4,"ngIf"],[1,"buscador-persona","shadow-3","border-0","rounded-4","overflow-hidden","modern-card"],["pHeader",""],[1,"alert","alert-warning","border-0","d-flex","gap-3","align-items-start","mb-4","small","modern-alert"],[1,"pi","pi-info-circle","fs-5","mt-1"],[1,"mb-0","text-justify"],["align","left","type","solid",1,"mb-3"],[1,"section-title"],[1,"pi","pi-search","me-2"],[1,"mb-2"],[1,"p-inputgroup","p-inputgroup-lg","modern-search-group"],[1,"p-inputgroup-addon"],[1,"pi","pi-search"],["pInputText","","required","","name","nombre","ngModel","","id","txtBusquedaPersona","type","text","placeholder","Escribe nombre o identidad (sin guiones)\u2026","autocomplete","off",3,"keypress"],["pButton","","type","button","id","btnBuscar","label","Buscar","icon","pi pi-arrow-right","iconPos","right",1,"p-button-primary",3,"click"],["id","ayudaBusqueda",1,"mt-1","small","text-muted","d-flex","flex-wrap","gap-2","align-items-center"],[1,"me-1"],["label","Mar\xEDa L\xF3pez","icon","pi pi-user",1,"me-1"],["label","0801*******","icon","pi pi-id-card"],[1,"d-flex","justify-content-between","align-items-center","gap-3"],[1,"d-flex","align-items-center","gap-3"],[1,"avatar-circle","d-none","d-md-flex"],[1,"pi","pi-user"],[1,"mb-0","fw-semibold"],[1,"text-muted"],[1,"d-none","d-md-flex","align-items-center","gap-2"],["value","Emelina","icon","pi pi-whatsapp","severity","success"],[1,"badge","rounded-pill","bg-light","text-muted","border","small"],[1,"buscador-persona","shadow-3","border-0","rounded-4","overflow-hidden","modern-card","mt-3"],["styleClass","p-datatable-sm p-datatable-gridlines modern-table","currentPageReportTemplate","Mostrando {first} - {last} de {totalRecords} resultados",3,"value","paginator","rows","rowsPerPageOptions","showCurrentPageReport"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"d-flex","justify-content-between","align-items-center"],["pButton","","type","button","icon","pi pi-arrow-left","label","Regresar",1,"p-button-text","p-button-danger",3,"click"],[1,"text-center",2,"width","120px"],[1,"text-center"],["pButton","","type","button","icon","pi pi-check","label","Seleccionar",1,"p-button-sm","p-button-rounded","p-button-success",3,"click"],[1,"font-monospace"],[3,"value","severity"],["colspan","6",1,"text-center","text-muted","py-4"],[1,"pi","pi-info-circle","me-2"],[1,"row","g-3"],[1,"col-md-4"],[1,"form-label","text-muted","small","mb-1"],[1,"p-input-icon-left","w-100"],[1,"pi","pi-id-card"],["pInputText","","type","text","readonly","",1,"w-100",3,"value"],["name","tipoConstancia","optionLabel","label","optionValue","value","placeholder","Seleccione un tipo",1,"w-100",3,"ngModelChange","ngModel","options"],[4,"ngIf"],[1,"col-12","mt-2","d-flex","justify-content-end"],["pButton","","type","button","icon","pi pi-save","label","Guardar solicitud",1,"p-button-primary","p-button-lg",3,"click"],["align","left","type","dashed",1,"mt-4","mb-3"],[1,"pi","pi-envelope","me-2"],["class","col-md-6",4,"ngIf"],["pInputText","","type","text","name","empresa","ngModel","","placeholder","Nombre de la empresa","required","",1,"w-100"],["type","month","name","mes","ngModel","","required","",1,"form-control"],["name","objeto","optionLabel","nombre_objeto","placeholder","Seleccione un objeto","required","",1,"w-100",3,"ngModelChange","ngModel","options"],["pInputText","","type","number","name","ano","ngModel","","required","","min","1900","max","2100","placeholder","Ej. 2023",1,"w-100"],["name","empresa","optionLabel","nombre","placeholder","Seleccione una empresa","required","",1,"w-100",3,"ngModelChange","ngModel","options"],[1,"col-md-6"],[1,"border-0","shadow-1","h-100"],[1,"table-responsive","mb-0"],[1,"table","table-sm","mb-0","align-middle"],[4,"ngFor","ngForOf"],[1,"d-flex","align-items-center","gap-2"],[1,"pi","pi-at","text-primary"],[1,"fw-semibold"],[1,"text-danger","small"],[1,"pi","pi-phone","text-primary"]],template:function(r,s){r&1&&(e(0,"div",8)(1,"div",9),u(2,he,32,0,"p-card",10)(3,Me,6,6,"p-card",11)(4,Oe,34,21,"p-card",11),t()()),r&2&&(c(2),m("ngIf",s.pantalla===1),c(),m("ngIf",s.pantalla===2),c(),m("ngIf",s.pantalla===3))},dependencies:[N,I,V,Q,z,q,H,W,L,K,Y,J,R,G,X,U,A,O,B,$,Z,re,ne,ie,se,le,oe,ae,me,ce,te,ee],encapsulation:2});let n=l;return n})();export{mt as SolicitudConstanciasPlanffaaComponent};
