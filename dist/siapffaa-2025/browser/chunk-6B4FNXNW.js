import{a as he,b as ve}from"./chunk-KAR6YIPS.js";import{a as pe,b as ge}from"./chunk-67YAOELL.js";import"./chunk-TRZFYDYS.js";import"./chunk-GHKXOCA3.js";import"./chunk-5OX6GXQO.js";import"./chunk-GIJM4SEB.js";import"./chunk-CLT3ZDBR.js";import{a as ce}from"./chunk-WGKG6BE3.js";import"./chunk-LEUMVM4K.js";import"./chunk-CNAZPYPR.js";import"./chunk-CYBTF2RE.js";import"./chunk-W7TJHXMM.js";import{j as te,l as ie}from"./chunk-EQMPRG6V.js";import"./chunk-36JN3LZY.js";import"./chunk-M763EXIE.js";import{b as me,c as ue}from"./chunk-MWNC3RUP.js";import{b as ae,e as re,f as ne,h as oe,j as le,k as se,x as de}from"./chunk-ZPMKEMCQ.js";import"./chunk-QE2BREUU.js";import"./chunk-JPTHL2WT.js";import"./chunk-VAG7FTYF.js";import{C as ee,c as W,d as $,e as J,j as H,k as K,l as Q,q as X,v as Y,z as Z}from"./chunk-FIATBDAH.js";import{Ca as l,Gb as O,Jb as x,Lb as a,Mb as g,Na as k,Nb as A,Qb as G,Rb as U,Sa as q,Sb as D,U as _,V as b,Wb as S,Ya as R,cc as I,fc as z,ib as p,jb as i,kb as t,lb as u,sb as P,wb as C,xb as v,za as V}from"./chunk-XJSKPFVT.js";import{f as N,g as E}from"./chunk-OXVY4BEJ.js";var T=N(he()),L=N(ve());var M=()=>({width:"100%"});function fe(f,y){if(f&1){let n=P();i(0,"div",24)(1,"div",25)(2,"div")(3,"h3",26),a(4," Consulta combinada "),i(5,"span",27),a(6,"(Flexible)"),t()(),i(7,"p",28),a(8," Seleccione uno o m\xE1s criterios para realizar la b\xFAsqueda. "),t()(),i(9,"div",29)(10,"button",30),C("click",function(){_(n);let r=v();return b(r.sacarPersonal_65_anos())}),u(11,"i",31),t()()(),i(12,"div",32)(13,"p",33),a(14," * Nuevas consultas: seleccione uno o m\xE1s criterios para realizar la b\xFAsqueda. "),t(),i(15,"p",34),a(16," * En la casilla "),i(17,"strong"),a(18,"Nombre / Identidad"),t(),a(19," puede ingresar cualquiera de las dos opciones. "),t(),i(20,"form",35,0)(22,"div",36)(23,"div",37)(24,"label",38),a(25,"Nombre / Identidad"),t(),u(26,"input",39,1),t()(),i(28,"div",36)(29,"div",37)(30,"label",38),a(31,"Sangre"),t(),u(32,"p-multiSelect",40,2),t()(),i(34,"div",36)(35,"div",37)(36,"label",38),a(37,"Sexo"),t(),u(38,"p-multiSelect",41,3),t()(),i(40,"div",36)(41,"div",37)(42,"label",38),a(43,"Religi\xF3n"),t(),u(44,"p-multiSelect",42,4),t()(),i(46,"div",36)(47,"div",37)(48,"label",38),a(49,"Serie"),t(),u(50,"input",43,5),t()(),i(52,"div",36)(53,"div",37)(54,"label",38),a(55,"# Cuenta"),t(),u(56,"input",44,6),t()(),i(58,"div",36)(59,"div",37)(60,"label",38),a(61,"Combatiente"),t(),u(62,"p-multiSelect",45,7),t()(),i(64,"div",36)(65,"div",37)(66,"label",38),a(67,"Usuario"),t(),u(68,"input",46,8),t()(),i(70,"div",36)(71,"div",37)(72,"label",38),a(73,"N\xFAmero Pasaporte"),t(),u(74,"input",47,9),t()(),i(76,"div",36)(77,"div",37)(78,"label",38),a(79,"Categor\xEDa"),t(),u(80,"p-multiSelect",48,10),t()(),i(82,"div",36)(83,"div",37)(84,"label",38),a(85,"Grado / Rango"),t(),u(86,"p-multiSelect",49,11),t()(),i(88,"div",36)(89,"div",37)(90,"label",38),a(91,"Fuerza Ingreso"),t(),i(92,"p-multiSelect",50,12),C("onChange",function(){_(n);let r=O(21),o=v();return b(o.sacarunidades(r.value.fuerza_))}),t()()(),i(94,"div",36)(95,"div",37)(96,"label",38),a(97,"Unidad"),t(),u(98,"p-multiSelect",51,13),t()(),i(100,"div",36)(101,"div",37)(102,"label",38),a(103,"Armas"),t(),u(104,"p-multiSelect",52,14),t()(),i(106,"div",36)(107,"div",37)(108,"label",38),a(109,"Idiomas"),t(),u(110,"p-multiSelect",53,15),t()(),i(112,"div",36)(113,"div",37)(114,"label",38),a(115,"Nivel educativo"),t(),i(116,"p-multiSelect",54,16),C("onChange",function(){_(n);let r=O(21),o=v();return b(o.sacarCarreras(r.value.nivel_profesion))}),t()()(),i(118,"div",36)(119,"div",37)(120,"label",38),a(121,"Profesi\xF3n"),t(),u(122,"p-multiSelect",55,17),t()(),i(124,"div",36)(125,"div",37)(126,"label",38),a(127,"Cursos"),t(),u(128,"p-multiSelect",56,18),t()(),i(130,"div",36)(131,"div",37)(132,"label",38),a(133,"Cumplea\xF1eros (mes)"),t(),u(134,"input",57,19),t()(),i(136,"div",36)(137,"div",37)(138,"label",58),a(139,"Estado"),t(),i(140,"div",59)(141,"div",60),C("click",function(){_(n);let r=v();return b(r.activofn())}),u(142,"input",61),i(143,"span"),a(144,"Activos"),t()(),i(145,"div",60),C("click",function(){_(n);let r=v();return b(r.bajafn())}),u(146,"input",61),i(147,"span"),a(148,"Bajas"),t()()()()(),i(149,"div",62)(150,"div",63)(151,"button",64),C("click",function(){_(n);let r=O(21),o=v();return b(o.buscar(r))}),u(152,"i",65),a(153," Buscar "),t(),i(154,"button",66),C("click",function(){_(n);let r=O(21),o=v();return b(o.limpiar(r))}),u(155,"i",67),a(156," Limpiar "),t()()()()()()}if(f&2){let n=v();l(32),x(S(41,M)),p("options",n.arregloSangre),l(6),x(S(42,M)),p("options",n.arregloSexo),l(6),x(S(43,M)),p("options",n.arregloReligion),l(18),x(S(44,M)),p("options",n.arregloCombatiente),l(18),x(S(45,M)),p("options",n.arregloCategorias),l(6),x(S(46,M)),p("options",n.arregloGrados),l(6),x(S(47,M)),p("options",n.arregloFuerzas),l(6),x(S(48,M)),p("options",n.ArregloUnidades),l(6),x(S(49,M)),p("options",n.arregloarmas),l(6),x(S(50,M)),p("options",n.arregloIdiomas),l(6),x(S(51,M)),p("options",n.arregloNiveles),l(6),x(S(52,M)),p("options",n.arregloCarreras),l(6),x(S(53,M)),p("options",n.arregloCursos),l(14),p("checked",n.estado.activos),l(4),p("checked",n.estado.bajas)}}function _e(f,y){if(f&1){let n=P();i(0,"tr")(1,"td",84)(2,"i",85),C("click",function(){let r=_(n).$implicit,o=v(2);return b(o.verPerfil(r))}),t()(),i(3,"td",84),u(4,"img",86),t(),i(5,"td"),a(6),t(),i(7,"td"),a(8),t(),i(9,"td"),a(10),t(),i(11,"td"),a(12),t(),i(13,"td"),a(14),t(),i(15,"td"),a(16),t(),i(17,"td"),a(18),t(),i(19,"td"),a(20),t(),i(21,"td"),a(22),t(),i(23,"td",87),a(24),t(),i(25,"td"),a(26),t(),i(27,"td"),a(28),t(),i(29,"td"),a(30),I(31,"date"),t(),i(32,"td"),a(33),t(),i(34,"td"),a(35),t(),i(36,"td"),a(37),t(),i(38,"td"),a(39),t(),i(40,"td"),a(41),t(),i(42,"td"),a(43),I(44,"date"),t(),i(45,"td"),a(46),t(),i(47,"td"),a(48),t()()}if(f&2){let n=y.$implicit,e=v(2);l(4),p("src",e._ServiciosSiapffaaService.url2+"sacarfoto/"+(n==null?null:n.foto),V),l(2),g(n.cuenta),l(2),g(n.identidad),l(2),g(n.grado),l(2),g(n.nombre_arma),l(2),g(n.categoria),l(2),g(n.nombre),l(2),g(n.apellido),l(2),g(n.Nombre_Puesto),l(2),g(n.serie),l(),p("ngClass",n.activo===1?"text-primary":"text-danger"),l(),A(" ",n.activo===1?"Activo":"Baja"," "),l(2),g(n.combatiente===1?"S\xED":"No"),l(2),g(n.unidad_asignado),l(2),g(z(31,23,n.fecha_asignacion,"yyyy-MM-dd","UTC")),l(3),A(" ",n.tiempo_asignacion<=1?n.tiempo_asignacion+" A\xF1o":n.tiempo_asignacion+" A\xF1os"," "),l(2),g(n.pasaporte),l(2),g(n.religion),l(2),g(n.sangre),l(2),g(n.sexo),l(2),g(z(44,27,n.fecha_nacimiento,"yyyy-MM-dd","UTC")),l(3),g(n.edad),l(2),g(n.idiomas)}}function be(f,y){if(f&1){let n=P();i(0,"div",68)(1,"div",25)(2,"div",69)(3,"button",70),C("click",function(){_(n);let r=v();return b(r.atras(0))}),t(),i(4,"div")(5,"h3",71),a(6,"Resultados de la consulta combinada"),t()()(),i(7,"div",29)(8,"button",72),C("click",function(){_(n);let r=v();return b(r.exportexcel2("tabla-resultado_1"))}),t()()(),i(9,"div",73)(10,"div",74)(11,"div",75)(12,"span",76),a(13," Resultados: "),i(14,"strong"),a(15),I(16,"currency"),t()()(),i(17,"div",77)(18,"span",78),u(19,"i",65),i(20,"input",79),D("ngModelChange",function(r){_(n);let o=v();return U(o.filtroTexto,r)||(o.filtroTexto=r),b(r)}),C("ngModelChange",function(){_(n);let r=v();return b(r.aplicarFiltro())}),t()()()(),i(21,"div",80)(22,"table",81)(23,"thead",82)(24,"tr")(25,"th"),a(26,"Opt"),t(),i(27,"th"),a(28,"Foto"),t(),i(29,"th"),a(30,"Cuenta"),t(),i(31,"th"),a(32,"Identidad"),t(),i(33,"th"),a(34,"Grado"),t(),i(35,"th"),a(36,"Arma"),t(),i(37,"th"),a(38,"Categor\xEDa"),t(),i(39,"th"),a(40,"Nombres"),t(),i(41,"th"),a(42,"Apellidos"),t(),i(43,"th"),a(44,"Cargo"),t(),i(45,"th"),a(46,"Serie"),t(),i(47,"th"),a(48,"Estado"),t(),i(49,"th"),a(50,"Combatiente"),t(),i(51,"th"),a(52,"Asignaci\xF3n"),t(),i(53,"th"),a(54,"Fecha Asignaci\xF3n"),t(),i(55,"th"),a(56,"Tiempo Asignaci\xF3n"),t(),i(57,"th"),a(58,"Pasaporte"),t(),i(59,"th"),a(60,"Religi\xF3n"),t(),i(61,"th"),a(62,"Sangre"),t(),i(63,"th"),a(64,"G\xE9nero"),t(),i(65,"th"),a(66,"Fecha Nacimiento"),t(),i(67,"th"),a(68,"Edad"),t(),i(69,"th"),a(70,"Idioma"),t()()(),i(71,"tbody"),R(72,_e,49,31,"tr",83),t()()()()()}if(f&2){let n=v();l(15),g(z(16,3,n.arregloResultadoFiltrado.length,"","")),l(5),G("ngModel",n.filtroTexto),l(52),p("ngForOf",n.arregloResultadoFiltrado)}}function xe(f,y){if(f&1){let n=P();i(0,"div")(1,"div",69)(2,"button",70),C("click",function(){_(n);let r=v();return b(r.atras(5))}),t()(),u(3,"app-visualizar-perfil",88),t()}if(f&2){let n=v();l(3),p("identidad",n.personaSelecionada.identidad)}}var Te=(()=>{let y=class y{constructor(e,r,o,s){this._ServiciosMensajesService=e,this._ServiciosSiapffaaService=r,this._Router=o,this.http=s,this.arregloResultado=[],this.arregloResultadoFiltrado=[],this.formularioBuscar=0,this.ArregloUnidades=[],this.arregloFuerzas=[],this.arregloNiveles=[],this.arregloCarreras=[],this.arregloCategorias=[{categoria:"Oficiales de las Armas",nivel:6},{categoria:"Oficiales Auxiliar",nivel:5},{categoria:"Sub Oficiales",nivel:4},{categoria:"Cadetes",nivel:3},{categoria:"Estudiantes",nivel:2},{categoria:"Tropa",nivel:1},{categoria:"Auxiliares",nivel:0}],this.arregloReligion=[{religion:"Catolico"},{religion:"Evangelico"},{religion:"Mormon"},{religion:"Testigo de Jehova"}],this.arregloSexo=[{sexo:"M",nombreSexo:"Masculino"},{sexo:"F",nombreSexo:"Femenino"}],this.arregloCombatiente=[{combatiente:"Si",code:1},{combatiente:"No",code:0}],this.arregloSangre=[{sangre:"A-"},{sangre:"A+"},{sangre:"B-"},{sangre:"B+"},{sangre:"O-"},{sangre:"O+"},{sangre:"AB-"},{sangre:"AB+"}],this.arregloIdiomas=[],this.arregloarmas=[],this.arregloCursos=[],this.arregloResultado_=[],this.arregloGrados=[],this.estado={activos:!0,bajas:!1},this.filtroTexto="",this.index_tab=0,this.sacarGrados=()=>{this._ServiciosSiapffaaService.sacarTodo_losGrados().subscribe({next:h=>{if(h.error)return this._ServiciosMensajesService.mensajeMalo(h.error);if(h.mensaje)return this._ServiciosMensajesService.mensajeMalo(h.mensaje);this.arregloGrados=h.resultado},error:()=>{this._ServiciosMensajesService.mensajeerrorServer()}})}}ngOnInit(){this.sacarFuerza(),this.sacarGrados(),this.usuariologuiado=JSON.parse(localStorage.getItem("user_login")).user}resetEstados(){this.estado={activos:!0,bajas:!1}}activofn(){this.estado.activos=!this.estado.activos}bajafn(){this.estado.bajas=!this.estado.bajas}crearCadenaestado(){return this.estado.activos===!0&&this.estado.bajas===!0?"and (activo= 1 or activo=2) ":this.estado.activos===!0?"and (activo= 1)":this.estado.bajas===!0?"and (activo= 2)":"and (activo= 1) "}sacarPersonal_65_anos(e){let o={cadena:"and (activo= 1) and month(fecha_nacimiento) = month('"+new Date().toISOString().split("T")[0]+"')  and edad_proxima=65"};this._ServiciosMensajesService.show(),this._ServiciosSiapffaaService.vistaSiapffaa(o).subscribe({next:s=>{if(this._ServiciosMensajesService.hide(),s.error)return this._ServiciosMensajesService.mensajeMalo(s.error);if(s.mensaje)return this._ServiciosMensajesService.mensajeMalo(s.mensaje);this.resetEstados(),this.arregloResultado=s.resultado||[],this.aplicarFiltro(),this.formularioBuscar=5},error:()=>{this._ServiciosMensajesService.hide(),this._ServiciosMensajesService.mensajeerrorServer()}})}buscar(e){let r={cadena:this.crearCadenaestado()+this.crearCadenaLike(e.value.nombre_id,"nombre_id")+this.crearCadena(e.value.serie,"serie")+this.crearCadena(e.value.cuenta,"cuenta")+this.crearCadena(e.value.usuario,"usuario")+this.crearCadena(e.value.pasaporte,"pasaporte")+this.devolverOR(e.value.fuerza_,"idfuerza","idfuerza_pertenece")+this.devolverOR(e.value.categoria_,"nivel","nivel")+this.devolverOR(e.value.nombre_grado_,"idgrados","idgrados")+this.devolverOR(e.value.religion_,"religion","religion")+this.devolverOR(e.value.sexo_,"sexo","sexo")+this.devolverOR(e.value.sangre_,"sangre","sangre")+this.devolverOR(e.value.combatiente_,"code","combatiente")+this.devolverOR(e.value.unidad_,"idunidad","idunidad_asignado")+this.devolverOR_like(e.value.idiomas_,"ididioma","idiomas")+this.devolverOR_like(e.value.nivel_profesion,"idnivel_educativo","nivel_profesion")+this.devolverOR_like(e.value.profesion_,"idprofeciones","profesion")+this.devolverOR(e.value.armas_,"idarmas","idarmas")+this.devolverOR_like(e.value.cursos_,"idcursos_militares","cursos_militares")+(e.value.fecha?`and ( month(fecha_nacimiento) = month('${e.value.fecha}-1'))`:"")+`${this.permisoUnidad?"and (idunidad_asignado = "+this.usuariologuiado.idunidad+")":this.permisoFuerza?this.usuariologuiado.idfuerza<=4?"and (idfuerza_pertenece = "+this.usuariologuiado.idfuerza+")":"and (idfuerza_asignada = "+this.usuariologuiado.idfuerza+")":""}`};if(r.cadena.length===0)return this._ServiciosMensajesService.mensajeAdvertencia("Porfavor selecione por lo menos un criterio de busqueda");this.arregloResultado=[],this.arregloResultadoFiltrado=[],this._ServiciosMensajesService.show(),this._ServiciosSiapffaaService.vistaSiapffaa(r).subscribe({next:o=>{if(this._ServiciosMensajesService.hide(),o.error)return this._ServiciosMensajesService.mensajeMalo(o.error);if(o.mensaje)return this._ServiciosMensajesService.mensajeMalo(o.mensaje);this.formularioBuscar=5,this.resetEstados(),this.arregloResultado=o.resultado||[],this.aplicarFiltro()},error:()=>{this._ServiciosMensajesService.hide(),this._ServiciosMensajesService.mensajeerrorServer()}})}aplicarFiltro(){let e=(this.filtroTexto||"").trim().toLowerCase();if(!e){this.arregloResultadoFiltrado=[...this.arregloResultado];return}this.arregloResultadoFiltrado=this.arregloResultado.filter(r=>((r.nombre||"")+" "+(r.apellido||"")+" "+(r.identidad||"")+" "+(r.unidad_asignado||"")+" "+(r.categoria||"")+" "+(r.grado||"")).toLowerCase().includes(e))}crearcadenaFecha(e){return e?`and ('${e}')''`:""}crearCadena(e,r){let o="";o+=e?r+" = '"+e+"'":"";let s=" and ("+o+") ";return s.includes("and ()")?"":s}crearCadenaLike(e,r){let o="";o+=e?r+" like '%"+e+"%'":"";let s=" and ("+o+") ";return s.includes("and ()")?"":s}verPerfil(e){this.personaSelecionada=e,this.formularioBuscar=3,this.guardarVisualizacion()}guardarVisualizacion(){let e={usuario:this.usuariologuiado,persona:this.personaSelecionada};this._ServiciosSiapffaaService.guardarHistorialVisualizarPerfil(e).subscribe(r=>{},r=>{})}atras(e){this.formularioBuscar=e}ventana_tab(e){this.index_tab=e.index,this.formularioBuscar=0}sacarFuerza(){this.arregloFuerzas=[],this._ServiciosSiapffaaService.sacarFuerza().subscribe(e=>{this.arregloFuerzas=e.resultado,this.sacarIdiomas()})}sacarunidades(e){if(e&&e.length!==0){let r={cadena:this.devolverOR(e,"idfuerza","idfuerza")};this.ArregloUnidades=[],this._ServiciosMensajesService.show(),this._ServiciosSiapffaaService.sacarUnidadesArreglo(r).subscribe(o=>{this._ServiciosMensajesService.hide(),this.ArregloUnidades=o.resultado},o=>{this._ServiciosMensajesService.hide(),this._ServiciosMensajesService.mensajeerrorServer()}),this.sacarArmas(e)}}devolverOR(e,r,o){if(e)if(e.length!==0){let s="";return e.forEach(h=>{let d=Object.keys(h).find(w=>w===r);s+=d?" or "+o+" = '"+h[d]+"'":""})," and ( '' "+s+") "}else return"";else return""}devolverOR_like(e,r,o){if(e)if(e.length!==0){let s="";return e.forEach(h=>{let d=Object.keys(h).find(w=>w===r);s+=d?"-"+h[d]+"-|":""})," and ( "+o+" REGEXP ('"+s.substring(0,s.length-1)+"')) "}else return"";else return""}sacarIdiomas(){this.arregloIdiomas=[],this._ServiciosSiapffaaService.sacaridiomas().subscribe(e=>{e.error?this._ServiciosMensajesService.mensajeMalo(e.error):this.arregloIdiomas=e.resultado,this.sacarNivelEducativo()})}sacarNivelEducativo(){this.arregloNiveles=[],this._ServiciosSiapffaaService.sacarnivelesEducativos().subscribe(e=>{e.error?this._ServiciosMensajesService.mensajeMalo(e.error):e.mensaje?this._ServiciosMensajesService.mensajeMalo(e.mensaje):this.arregloNiveles=e.resultado,this.cursus_militares()},e=>{this._ServiciosMensajesService.mensajeerrorServer()})}sacarCarreras(e){if(e&&e.length!==0){var r={cadena:this.devolverOR(e,"idnivel_educativo","idnivelEducativo")};this.arregloCarreras=[],this._ServiciosSiapffaaService.sacarProfecionArreglo(r).subscribe(o=>{o.error?this._ServiciosMensajesService.mensajeMalo(o.error):o.mensaje?this._ServiciosMensajesService.mensajeMalo(o.mensaje):this.arregloCarreras=o.resultado},o=>{this._ServiciosMensajesService.mensajeerrorServer()})}}sacarArmas(e){if(e&&e.length!==0){let r={cadena:this.devolverOR(e,"idfuerza","fuerza_idfuerza")};this._ServiciosSiapffaaService.sacararmasArreglo(r).subscribe(o=>{this.arregloarmas=o.resultado})}}cursus_militares(){this._ServiciosSiapffaaService.sacarTotoCursosMilitares().subscribe(e=>{this.arregloCursos=e.resultado})}limpiar(e){e.reset(),this.filtroTexto="",this.arregloResultado=[],this.arregloResultadoFiltrado=[]}busquedaSimple(e){this._ServiciosMensajesService.show();let o={cadena:this.crearCadenaestado()+this.crearCadenaLike(e.value.nombre_id,"nombre_id")+`${this.permisoUnidad?"and (idunidad_asignado = "+this.usuariologuiado.idunidad+")":this.permisoFuerza?this.usuariologuiado.idfuerza<=4?"and (idfuerza_pertenece = "+this.usuariologuiado.idfuerza+")":"and (idfuerza_asignada = "+this.usuariologuiado.idfuerza+")":""}`};this._ServiciosSiapffaaService.buscarPersonasporNombreID(o).subscribe(s=>{this._ServiciosMensajesService.hide(),s.error?this._ServiciosMensajesService.mensajeMalo(s.error):s.mensaje?this._ServiciosMensajesService.mensajeMalo(s.mensaje):(this.resetEstados(),this.arregloResultado_=s.resultado,this.formularioBuscar=1)},s=>{this._ServiciosMensajesService.hide(),this._ServiciosMensajesService.mensajeerrorServer()})}reset(){this.formularioBuscar=0}exportarExcel(){return E(this,null,function*(){let e=new T.Workbook,r=e.addWorksheet("Resultados");r.columns=[{header:"Opt",key:"opt",width:6},{header:"Foto",key:"foto",width:15},{header:"Identidad",key:"identidad",width:18},{header:"Grado",key:"grado",width:18},{header:"Categor\xEDa",key:"categoria",width:18},{header:"Nombres",key:"nombre",width:20},{header:"Apellidos",key:"apellido",width:20},{header:"Serie",key:"serie",width:10},{header:"Estado",key:"estado",width:12},{header:"Combatiente",key:"combatiente",width:12},{header:"Tiempo Asignaci\xF3n",key:"unidad_asignado",width:25},{header:"Pasaporte",key:"pasaporte",width:15},{header:"Religi\xF3n",key:"religion",width:15},{header:"Sangre",key:"sangre",width:10},{header:"G\xE9nero",key:"sexo",width:10},{header:"Fecha Nacimiento",key:"fecha_nacimiento",width:18},{header:"Edad",key:"edad",width:8}],r.getRow(1).font={bold:!0};let o=this.arregloResultadoFiltrado&&this.arregloResultadoFiltrado.length>0?this.arregloResultadoFiltrado:this.arregloResultado_;for(let d of o){let c=r.addRow({opt:"",foto:"",identidad:d.identidad,grado:d.grado,categoria:d.categoria,nombre:d.nombre,apellido:d.apellido,serie:d.serie,estado:d.activo===1?"Activo":"Baja",combatiente:d.combatiente===1?"Si":"No",unidad_asignado:d.unidad_asignado,pasaporte:d.pasaporte,religion:d.religion,sangre:d.sangre,sexo:d.sexo,fecha_nacimiento:d.fecha_nacimiento?new Date(d.fecha_nacimiento).toISOString().substring(0,10):"",edad:d.edad}).number,m=this._ServiciosSiapffaaService.url2+"sacarfoto/"+d?.foto,j=yield this.cargarImagenBase64(m);if(j){let F=e.addImage({base64:j,extension:"jpeg"}),B=`B${c}:B${c}`;r.addImage(F,B),r.getRow(c).height=60}}let s=yield e.xlsx.writeBuffer(),h=new Blob([s],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});(0,L.saveAs)(h,`resultados_personal_${new Date().toISOString().substring(0,10)}.xlsx`)})}cargarImagenBase64(e){return E(this,null,function*(){try{let o=yield(yield fetch(e)).blob();return yield new Promise((s,h)=>{let d=new FileReader;d.onloadend=()=>{let w=d.result;s(w)},d.onerror=()=>h(null),d.readAsDataURL(o)})}catch(r){return console.error("Error cargando imagen",r),null}})}atrasLink(e){this._Router.navigate([e])}descargarImagenComoArrayBuffer(e){return E(this,null,function*(){try{return yield this.http.get(e,{responseType:"arraybuffer"}).toPromise()}catch(r){return console.error("Error descargando imagen",r),null}})}exportexcel2(e){return E(this,null,function*(){this._ServiciosMensajesService.show();let r=new T.Workbook,o=r.addWorksheet("Resultados");o.columns=[{header:"Cuenta",key:"cuenta",width:18},{header:"Identidad",key:"identidad",width:20},{header:"Grado",key:"grado",width:15},{header:"Arma",key:"arma",width:18},{header:"Categor\xEDa",key:"categoria",width:18},{header:"Nombres",key:"nombres",width:22},{header:"Apellidos",key:"apellidos",width:22},{header:"Cargo",key:"cargo",width:25},{header:"Serie",key:"serie",width:14},{header:"Estado",key:"estado",width:12},{header:"Combatiente",key:"combatiente",width:14},{header:"Asignaci\xF3n",key:"asignacion",width:22},{header:"Fecha Asignaci\xF3n",key:"fecha_asignacion",width:18},{header:"Tiempo Asignaci\xF3n",key:"tiempo_asignacion",width:18},{header:"Pasaporte",key:"pasaporte",width:18},{header:"Religi\xF3n",key:"religion",width:18},{header:"Sangre",key:"sangre",width:12},{header:"G\xE9nero",key:"genero",width:12},{header:"Fecha Nac.",key:"fecha_nacimiento",width:18},{header:"Edad",key:"edad",width:8},{header:"Idioma",key:"idioma",width:22}],o.spliceColumns(1,0,{header:"Foto",key:"foto"}),o.getColumn(1).width=14,o.getRow(1).font={bold:!0},o.getRow(1).alignment={vertical:"middle",horizontal:"center"},o.getRow(1).height=22;let s=this.arregloResultadoFiltrado||[],h=2;for(let c of s){let m=o.getRow(h);if(m.getCell("B").value=c.cuenta,m.getCell("C").value=c.identidad,m.getCell("D").value=c.grado,m.getCell("E").value=c.nombre_arma,m.getCell("F").value=c.categoria,m.getCell("G").value=c.nombre,m.getCell("H").value=c.apellido,m.getCell("I").value=c.Nombre_Puesto,m.getCell("J").value=c.serie,m.getCell("K").value=c.activo===1?"Activo":"Baja",m.getCell("L").value=c.combatiente===1?"S\xED":"No",m.getCell("M").value=c.unidad_asignado,m.getCell("N").value=c.fecha_asignacion,m.getCell("O").value=c.tiempo_asignacion,m.getCell("P").value=c.pasaporte,m.getCell("Q").value=c.religion,m.getCell("R").value=c.sangre,m.getCell("S").value=c.sexo,m.getCell("T").value=c.fecha_nacimiento,m.getCell("U").value=c.edad,m.getCell("V").value=c.idiomas,m.height=52,c.foto){let j=this._ServiciosSiapffaaService.url2+"sacarfoto/"+c.foto,F=yield this.descargarImagenComoArrayBuffer(j);if(F){let B=r.addImage({buffer:F,extension:"jpeg"});o.addImage(B,{tl:{col:.2,row:h-.8},ext:{width:48,height:48},editAs:"oneCell"})}}h++}o.eachRow(c=>{c.eachCell(m=>{m.border={top:{style:"thin",color:{argb:"FFE5E7EB"}},left:{style:"thin",color:{argb:"FFE5E7EB"}},bottom:{style:"thin",color:{argb:"FFE5E7EB"}},right:{style:"thin",color:{argb:"FFE5E7EB"}}}})});let d=yield r.xlsx.writeBuffer(),w=new Blob([d],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});this._ServiciosMensajesService.hide(),(0,L.saveAs)(w,"resultados_consulta_combinada.xlsx")})}};y.\u0275fac=function(r){return new(r||y)(k(Z),k(ee),k(Y),k(X))},y.\u0275cmp=q({type:y,selectors:[["app-busqueda-personalizada"]],decls:4,vars:3,consts:[["buscarGenerales","ngForm"],["nombre_id","ngModel"],["sangre_","ngModel"],["sexo_","ngModel"],["religion_","ngModel"],["serie","ngModel"],["cuenta","ngModel"],["combatiente_","ngModel"],["usuario","ngModel"],["pasaporte","ngModel"],["categoria_","ngModel"],["grado","ngModel"],["fuerza_","ngModel"],["unidad_","ngModel"],["armas_","ngModel"],["idiomas_","ngModel"],["nivel_profesion","ngModel"],["profesion_","ngModel"],["cursos_","ngModel"],["fecha","ngModel"],[1,"consulta-wrapper","container-fluid"],["class","panel-card panel-card--warning h-100 d-flex flex-column",4,"ngIf"],["class","panel-card panel-card--danger h-100 d-flex flex-column mt-3 mt-md-0",4,"ngIf"],[4,"ngIf"],[1,"panel-card","panel-card--warning","h-100","d-flex","flex-column"],[1,"panel-header","d-flex","align-items-center","justify-content-between"],[1,"panel-title","mb-1"],[1,"panel-title-tag"],[1,"panel-subtitle","mb-0"],[1,"d-flex","align-items-center"],["pButton","","type","button","label","65 a\xF1os","styleClass","btn-pill btn-pill-ghost",2,"background-color","black","color","white","border-radius","50px",3,"click"],[1,"pi","pi-clock"],[1,"panel-body","flex-grow-1"],[1,"form-hint","form-hint--warning","mb-1"],[1,"form-hint","form-hint--info","mb-3"],[1,"row","g-3","consulta-form"],[1,"col-12","col-sm-6","col-md-3"],[1,"form-group-custom"],[1,"form-label-custom"],["type","text","ngModel","","name","nombre_id","placeholder","Ingrese nombre o identidad",1,"form-control","form-control-sm"],["ngModel","","name","sangre_","defaultLabel","Sangre","optionLabel","sangre","display","chip",3,"options"],["ngModel","","name","sexo_","defaultLabel","Sexo","optionLabel","nombreSexo","display","chip",3,"options"],["ngModel","","name","religion_","defaultLabel","Religi\xF3n","optionLabel","religion","display","chip",3,"options"],["type","text","name","serie","ngModel","","placeholder","Ingrese la serie",1,"form-control","form-control-sm"],["type","text","name","cuenta","ngModel","","placeholder","Ingrese la cuenta",1,"form-control","form-control-sm"],["ngModel","","name","combatiente_","defaultLabel","Combatiente","optionLabel","combatiente","display","chip",3,"options"],["type","text","name","usuario","ngModel","","placeholder","Usuario del sistema",1,"form-control","form-control-sm"],["type","text","name","pasaporte","ngModel","","placeholder","Ingrese pasaporte",1,"form-control","form-control-sm"],["ngModel","","name","categoria_","defaultLabel","Categor\xEDa","optionLabel","categoria","display","chip",3,"options"],["ngModel","","name","nombre_grado_","defaultLabel","Grado / Rango","optionLabel","nombre_grado","display","chip",3,"options"],["ngModel","","name","fuerza_","defaultLabel","Fuerza","optionLabel","nombre","display","chip",3,"onChange","options"],["ngModel","","name","unidad_","defaultLabel","Unidad","optionLabel","unidad","display","chip",3,"options"],["ngModel","","name","armas_","defaultLabel","Armas","optionLabel","nombre_arma_concat","display","chip",3,"options"],["ngModel","","name","idiomas_","defaultLabel","Idiomas","optionLabel","descripcion","display","chip",3,"options"],["ngModel","","name","nivel_profesion","defaultLabel","Nivel educativo","optionLabel","nombreNivel","display","chip",3,"onChange","options"],["ngModel","","name","profesion_","defaultLabel","Profesi\xF3n","optionLabel","profesion","display","chip",3,"options"],["ngModel","","name","cursos_","defaultLabel","Cursos","optionLabel","nombre_cursos","display","chip",3,"options"],["type","month","name","fecha","ngModel","",1,"form-control","form-control-sm"],[1,"form-label-custom","d-block"],[1,"estado-toggle-group"],[1,"estado-toggle",3,"click"],["type","checkbox",3,"checked"],[1,"col-12"],[1,"d-flex","justify-content-end","gap-2","mt-2"],["pButton","","type","button","label","Buscar","iconPos","left",2,"background-color","black","color","white","border-radius","20px","height","50px",3,"click"],[1,"pi","pi-search"],["pButton","","type","button","label","Limpiar","styleClass","btn-pill btn-pill-danger",2,"background-color","rgb(38, 116, 31)","color","white","border-radius","20px","height","50px",3,"click"],[1,"pi","pi-filter-slash"],[1,"panel-card","panel-card--danger","h-100","d-flex","flex-column","mt-3","mt-md-0"],[1,"d-flex","align-items-center","gap-2"],["pButton","","type","button","title","Atr\xE1s","icon","pi pi-arrow-left","styleClass","btn-icon-ghost",3,"click"],[1,"panel-title","mb-0"],["pButton","","type","button","label","Exportar","icon","pi pi-file-excel","iconPos","left","styleClass","btn-pill btn-pill-success",3,"click"],[1,"panel-body","flex-grow-1","d-flex","flex-column"],[1,"row","align-items-center","mb-2"],[1,"col-12","col-md-4"],[1,"result-count"],[1,"col-12","col-md-8","mt-2","mt-md-0","d-flex","justify-content-md-end"],[1,"p-input-icon-left","filtro-box"],["pInputText","","type","text","placeholder","Filtrar por nombre, identidad, unidad...",3,"ngModelChange","ngModel"],[1,"results-table-wrapper","flex-grow-1"],["id","tabla-resultado_1",1,"table","table-sm","table-hover","table-bordered","mb-0","align-middle","table-resultados"],[1,"table-light"],[4,"ngFor","ngForOf"],[1,"text-center"],[1,"pi","pi-eye","text-primary","cursor-pointer",3,"click"],["alt","Foto",1,"foto-mini","sombra",3,"src"],[3,"ngClass"],[3,"identidad"]],template:function(r,o){r&1&&(i(0,"div",20),R(1,fe,157,54,"div",21)(2,be,73,7,"div",22)(3,xe,4,1,"div",23),t()),r&2&&(l(),p("ngIf",o.formularioBuscar===0),l(),p("ngIf",o.formularioBuscar===5),l(),p("ngIf",o.formularioBuscar===3))},dependencies:[de,se,ae,re,ne,le,oe,ge,pe,Q,W,$,J,ce,ie,te,ue,me,K,H],styles:[".consulta-wrapper[_ngcontent-%COMP%]{height:100%;padding:.75rem;background:#f5f7fb;display:flex;flex-direction:column;gap:.75rem}.panel-card[_ngcontent-%COMP%]{background:#fff;border-radius:.9rem;border:1px solid #dde3f0;box-shadow:0 6px 14px #0f172a0f;padding:.85rem 1rem}.panel-card--warning[_ngcontent-%COMP%]{border-top:3px solid #fbbf24}.panel-card--danger[_ngcontent-%COMP%]{border-top:3px solid #f97373}.panel-header[_ngcontent-%COMP%]{padding-bottom:.55rem;margin-bottom:.5rem;border-bottom:1px solid #e5e7eb}.panel-title[_ngcontent-%COMP%]{font-size:1rem;font-weight:600;color:#111827}.panel-title-tag[_ngcontent-%COMP%]{font-size:.75rem;font-weight:400;color:#9ca3af}.panel-subtitle[_ngcontent-%COMP%]{font-size:.8rem;color:#6b7280}.form-hint[_ngcontent-%COMP%]{font-size:.8rem}.form-hint--warning[_ngcontent-%COMP%]{color:#b91c1c}.form-hint--info[_ngcontent-%COMP%]{color:#2563eb}.consulta-form[_ngcontent-%COMP%]{font-size:.85rem}.form-group-custom[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.2rem}.form-label-custom[_ngcontent-%COMP%]{font-size:.78rem;font-weight:500;color:#374151}.form-control-sm[_ngcontent-%COMP%]{border-radius:.6rem;border-color:#d1d5db;font-size:.8rem;padding:.28rem .5rem;transition:border-color .15s ease,box-shadow .15s ease}.form-control-sm[_ngcontent-%COMP%]:focus{border-color:#2563eb;box-shadow:0 0 0 .12rem #2563eb33}.estado-toggle-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.2rem}.estado-toggle[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:.3rem;cursor:pointer;font-size:.8rem;padding:.18rem .5rem;border-radius:999px;border:1px solid transparent;transition:background .15s ease,border-color .15s ease}.estado-toggle[_ngcontent-%COMP%]:hover{background:#eef2ff;border-color:#c7d2fe}[_nghost-%COMP%]     .p-multiselect{width:100%;min-height:2.35rem;border-radius:.6rem;font-size:.78rem}[_nghost-%COMP%]     .p-multiselect-label{padding-top:.25rem!important;padding-bottom:.25rem!important}[_nghost-%COMP%]     .btn-pill{border-radius:999px!important;font-size:.8rem;padding:.25rem .9rem!important;display:inline-flex;align-items:center;gap:.35rem}[_nghost-%COMP%]     .btn-pill-primary{background:linear-gradient(135deg,#2563eb,#3b82f6);border:none;color:#f9fafb;box-shadow:0 4px 10px #2563eb59}[_nghost-%COMP%]     .btn-pill-primary:hover{filter:brightness(1.05)}[_nghost-%COMP%]     .btn-pill-danger{background:linear-gradient(135deg,#dc2626,#f97373);border:none;color:#fef2f2;box-shadow:0 4px 10px #dc262659}[_nghost-%COMP%]     .btn-pill-danger:hover{filter:brightness(1.05)}[_nghost-%COMP%]     .btn-pill-success{background:linear-gradient(135deg,#16a34a,#22c55e);border:none;color:#ecfdf3;box-shadow:0 4px 10px #16a34a59}[_nghost-%COMP%]     .btn-pill-success:hover{filter:brightness(1.05)}[_nghost-%COMP%]     .btn-pill-ghost{background:#2563eb0f;border:1px solid rgba(37,99,235,.22);color:#1d4ed8;box-shadow:none}[_nghost-%COMP%]     .btn-icon-ghost{border-radius:999px!important;background:transparent!important;border:1px solid #e5e7eb!important;width:2rem;height:2rem;padding:0;display:inline-flex;align-items:center;justify-content:center}[_nghost-%COMP%]     .btn-icon-ghost .pi{font-size:.9rem;color:#4b5563}[_nghost-%COMP%]     .btn-icon-ghost:hover{background:#e5f0ff!important;border-color:#bfdbfe!important}.result-count[_ngcontent-%COMP%]{font-size:.8rem;color:#4b5563}.results-table-wrapper[_ngcontent-%COMP%]{border-radius:.85rem;border:1px solid #e5e7eb;background:#fff;padding:.4rem;overflow:auto;max-height:400px}.table-resultados[_ngcontent-%COMP%]{font-size:.78rem}.table-resultados[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{position:sticky;top:0;z-index:2;background:#f3f4f6;color:#111827;border-color:#e5e7eb;font-weight:500;white-space:nowrap}.table-resultados[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{white-space:nowrap}.table-resultados[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(2n){background:#f9fafb}.table-resultados[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:#e0edff}.cursor-pointer[_ngcontent-%COMP%]{cursor:pointer}.table-resultados[_ngcontent-%COMP%]   i.pi-eye[_ngcontent-%COMP%]{font-size:1rem;transition:transform .12s ease,color .12s ease}.table-resultados[_ngcontent-%COMP%]   i.pi-eye[_ngcontent-%COMP%]:hover{transform:scale(1.1);color:#1d4ed8}.foto-mini[_ngcontent-%COMP%]{height:70px;width:70px;border-radius:.8rem;border:3px solid #111827;object-fit:cover;box-shadow:0 7px 18px #0f172a66}@media (max-width: 768px){.panel-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:.45rem}.results-table-wrapper[_ngcontent-%COMP%]{max-height:320px}}.filtro-box[_ngcontent-%COMP%]{display:inline-flex;align-items:center;width:100%;max-width:280px}[_nghost-%COMP%]     .filtro-box input.p-inputtext{width:100%;border-radius:999px;font-size:.8rem;padding:.25rem .9rem .25rem 2.1rem}"]});let f=y;return f})();export{Te as BusquedaPersonalizadaComponent};
