import{a as oe,b as ne}from"./chunk-TK4RTEGY.js";import"./chunk-YULUHQQ2.js";import{b as re,c as ie}from"./chunk-AWVXNJFH.js";import"./chunk-5OX6GXQO.js";import"./chunk-GIJM4SEB.js";import"./chunk-CLT3ZDBR.js";import"./chunk-LEUMVM4K.js";import{a as ee,b as te}from"./chunk-CNAZPYPR.js";import"./chunk-CYBTF2RE.js";import"./chunk-W7TJHXMM.js";import{j as L,l as P}from"./chunk-EQMPRG6V.js";import"./chunk-36JN3LZY.js";import"./chunk-M763EXIE.js";import"./chunk-MWNC3RUP.js";import{b as q,e as U,f as X,h as H,j as R,k as J,l as K,s as Q,t as Y,x as Z,y as $}from"./chunk-ZPMKEMCQ.js";import"./chunk-QE2BREUU.js";import"./chunk-JPTHL2WT.js";import{ea as B}from"./chunk-VAG7FTYF.js";import{C as W,l as G,z as N}from"./chunk-FIATBDAH.js";import{Ca as d,Gb as j,Jb as D,Lb as n,Mb as F,Na as M,Nb as w,Ob as k,Qb as S,Rb as v,Sa as O,Sb as f,U as u,V as p,Wb as V,Ya as I,db as y,eb as x,gb as z,hb as T,ib as g,jb as o,kb as i,lb as C,sb as E,wb as h,xb as _}from"./chunk-XJSKPFVT.js";import{g as A}from"./chunk-OXVY4BEJ.js";var ae=()=>({width:"450px"}),se=()=>({width:"380px"}),le=(l,m)=>m.IdCupo;function de(l,m){if(l&1){let a=E();o(0,"button",32),h("click",function(){u(a),_();let t=j(19),e=_();return p(e.buscarCupos(t))}),i()}}function ce(l,m){l&1&&(o(0,"div",31)(1,"div",33)(2,"span",34),n(3,"Cargando..."),i()(),o(4,"span",35),n(5,"Buscando cupos..."),i()())}function ue(l,m){if(l&1){let a=E();o(0,"div",3)(1,"div",19)(2,"div",20)(3,"div",21)(4,"div",22)(5,"h5",23),C(6,"i",24),n(7," Habilitar cupos para ascensos "),i()(),o(8,"div",25)(9,"p",26),n(10," Selecciona la "),o(11,"strong"),n(12,"Fuerza"),i(),n(13," y la "),o(14,"strong"),n(15,"Unidad"),i(),n(16," a la que deseas habilitar nuevos cupos. "),i(),C(17,"hr"),o(18,"form",6,2)(20,"div",7)(21,"label",8),n(22," Fuerza "),i(),o(23,"p-select",27),f("ngModelChange",function(t){u(a);let e=_();return v(e.fuerzaSelected,t)||(e.fuerzaSelected=t),p(t)}),h("onChange",function(){u(a);let t=_();return p(t.sacarunidades())}),i()(),o(24,"div",7)(25,"label",8),n(26," Unidad "),i(),o(27,"p-select",28),f("ngModelChange",function(t){u(a);let e=_();return v(e.unidadSelected,t)||(e.unidadSelected=t),p(t)}),i()(),o(28,"div",29),y(29,de,1,0,"button",30)(30,ce,6,0,"div",31),i()()()()()()()}if(l&2){let a=_();d(23),g("options",a.arregloFuerzas),S("ngModel",a.fuerzaSelected),g("showClear",!0)("filter",!0),d(4),g("options",a.ArregloUnidades),S("ngModel",a.unidadSelected),g("showClear",!0)("filter",!0),d(2),x(a.banderaEspiner===0?29:30)}}function pe(l,m){if(l&1){let a=E();o(0,"div",44)(1,"div",46)(2,"div",47),C(3,"img",48),o(4,"div",49)(5,"span",50),C(6,"i",51),n(7," Ascenso "),i()()(),o(8,"div",52)(9,"h6",53),C(10,"i",54),n(11," Detalle de cupo "),i(),o(12,"ul",55)(13,"li")(14,"strong"),n(15,"Fuerza:"),i(),n(16),i(),o(17,"li")(18,"strong"),n(19,"Unidad:"),i(),n(20),i(),o(21,"li")(22,"strong"),n(23,"Categor\xEDa:"),i(),n(24),i(),o(25,"li")(26,"strong"),n(27,"Grado / Rango:"),i(),n(28),i(),o(29,"li")(30,"strong"),n(31,"Fecha ascenso:"),i(),n(32),i(),o(33,"li")(34,"strong"),n(35,"Cupos:"),i(),n(36),i()()(),o(37,"div",56)(38,"button",57),h("click",function(){let t=u(a).$implicit,e=_(2);return e.seleccionarTarjeta(t),p(e.mostrarCambiarCupos=!0)}),C(39,"i",58),n(40," Cupos "),i(),o(41,"button",59),h("click",function(){let t=u(a).$implicit,e=_(2);return p(e.eliminarAscenso(t))}),C(42,"i",60),n(43," Eliminar "),i()()()()}if(l&2){let a=m.$implicit,r=_(2);d(16),w(" ",r.fuerzaSelected==null?null:r.fuerzaSelected.nombre),d(4),w(" ",a.Corto),d(4),w(" ",a.Categoria),d(4),w(" ",a.Grado),d(4),w(" ",a.FechaAutorizada),d(4),w(" ",a.Cupos)}}function me(l,m){l&1&&(o(0,"div",45),C(1,"i",61),o(2,"p",39),n(3,"No hay cupos registrados para esta unidad a\xFAn."),i()())}function ge(l,m){if(l&1){let a=E();o(0,"div",4)(1,"div",36)(2,"div",22)(3,"div",31)(4,"button",37),h("click",function(){u(a);let t=_();return p(t.atras(0))}),C(5,"i",38),i(),o(6,"h5",39),n(7," Habilitar ascensos a: "),o(8,"strong"),n(9),i()()(),o(10,"button",40),h("click",function(){u(a);let t=_();return t.limpiar(),p(t.mostrarAgregarAscenso=!0)}),i()(),o(11,"div",25)(12,"div",41)(13,"div",19)(14,"div",42)(15,"div",43),z(16,pe,44,6,"div",44,le),i(),y(18,me,4,0,"div",45),i()()()()()()}if(l&2){let a=_();d(4),g("text",!0)("rounded",!0)("raised",!1),d(5),F(a.unidadSelected==null?null:a.unidadSelected.unidad),d(7),T(a.arregloCupos),d(2),x(!a.arregloCupos||a.arregloCupos.length===0?18:-1)}}function _e(l,m){if(l&1&&n(0),l&2){let a=m.$implicit;k(" ",a.codigo," - ",a.Grado," ")}}var Oe=(()=>{let m=class m{constructor(r,t){this._DatospersonalesService=r,this._ServicioMensajeService=t,this.arregloFuerzas=new Array,this.ArregloUnidades=new Array,this.banderaEspiner=0,this.ventana=0,this.arregloControlGrados=new Array,this.arregloGrados=new Array,this.arregloCupos=new Array,this.mostrarAgregarAscenso=!1,this.mostrarCambiarCupos=!1,this.gradoSelected=null,this.fechaAscenso=null,this.cupos=null,this.cuposEdit=null}ngOnInit(){this.sacarFuerzas(),this.sacarcontrolGrados()}sacarcontrolGrados(){var r;this.arregloControlGrados=new Array,this._DatospersonalesService.sacarControlGrados(r).subscribe(t=>{t.error?this._DatospersonalesService.mensajeError(t.error):t.mensaje?this._DatospersonalesService.mensajeError(t.mensaje):this.arregloControlGrados=t.resultado},t=>{this._DatospersonalesService.mensajeError("ERROR DE CONEXION")})}sacarFuerzas(){this.ArregloUnidades=new Array,this._DatospersonalesService.sacarFuerza().subscribe(r=>{r.error?this._DatospersonalesService.mensajeError(r.error):r.mensaje?this._DatospersonalesService.mensajeError(r.mensaje):this.arregloFuerzas=r.resultado},r=>{this._DatospersonalesService.mensajeError("ERROR DE CONEXION")})}refrescarCupos(){this.arregloCupos=new Array;var r={idunidad:this.unidadSelected.idunidad};this._DatospersonalesService.sacarcuposAscenso(r).subscribe(t=>{t.error?this._DatospersonalesService.mensajeError(t.error):(this.ventana=1,t.mensaje?this._DatospersonalesService.mensajeError(t.mensaje):this.arregloCupos=t.resultado)},t=>{this._DatospersonalesService.mensajeError("ERROR DE CONEXION")})}buscarCupos(r){if(r.valid){this.arregloCupos=new Array;var t={idunidad:this.unidadSelected.idunidad};this._ServicioMensajeService.show(),this._DatospersonalesService.sacarcuposAscenso(t).subscribe({next:e=>{if(this._ServicioMensajeService.hide(),e.error)return this._DatospersonalesService.mensajeError(e.error);if(e.mensaje)return this.ventana=1;this.ventana=1,this.arregloCupos=e.resultado},error(e){this._ServicioMensajeService.hide(),this._DatospersonalesService.mensajeError("ERROR DE CONEXION")}})}else this._DatospersonalesService.mensajeError("FORMULARIO INVALIDO")}sacarGrados(){var r;this.fuerzaSelected.idfuerza===2||this.fuerzaSelected.idfuerza===3||this.fuerzaSelected.idfuerza===4?r=this.fuerzaSelected.idfuerza:r=3;var t={idfuerza:r,idgradoControl:this.idgradoControlSelected.idControl_Grado};this.arregloGrados=new Array,this._DatospersonalesService.sacarGradosSoloAscenso(t).subscribe(e=>{e.error?this._DatospersonalesService.mensajeError(e.error):e.mensaje?this._DatospersonalesService.mensajeError(e.mensaje):this.arregloGrados=e.resultado},e=>{this._DatospersonalesService.mensajeError("ERROR DE CONEXION")})}limpiar(){this.arregloControlGrados=new Array,this.arregloGrados=new Array,this.sacarcontrolGrados()}guardarCupos(r){return A(this,null,function*(){if(yield this._ServicioMensajeService.mensajePregunta("Esta seguro de guardar los cupos de ascenso"))if(r.valid){var e={idunidad:this.unidadSelected.idunidad,cupos:r.value.cupos,idgrado:r.value.gradoSelected.idgrado,idcategoria:r.value.gradoSelected.idcategoria,fecha_ascenso:new Date(this.fechaAscenso).toISOString().split("T")[0]};this._ServicioMensajeService.show(),this._DatospersonalesService.AgregarCupoAscenso(e).subscribe({next:c=>{this._ServicioMensajeService.hide(),c.error?this._DatospersonalesService.mensajeError(c.error.sqlMessage):c.mensaje?this._DatospersonalesService.mensajeError(c.mensaje):(r.reset(),this.refrescarCupos())},error:()=>{this._ServicioMensajeService.hide(),this._DatospersonalesService.mensajeError("ERROR DE CONEXION")}}),r.reset()}else this._DatospersonalesService.mensajeError("FORMULARIO INVALIDO")})}sacarunidades(){var r={idfuerza:this.fuerzaSelected.idfuerza};this._ServicioMensajeService.show(),this._DatospersonalesService.sacarunidad(r).subscribe({next:t=>{this._ServicioMensajeService.hide(),t.error?this._DatospersonalesService.mensajeError(t.error):t.mensaje?this._DatospersonalesService.mensajeError(t.mensaje):this.ArregloUnidades=t.resultado},error:t=>{this._ServicioMensajeService.hide(),this._DatospersonalesService.mensajeError("ERROR DE CONEXION")}})}atras(r){this.ventana=r}eliminarAscenso(r){return A(this,null,function*(){var t=yield this._DatospersonalesService.mensajePregunta("Eliminar","Esta seguro de eliminar esta Tarjete de Ascenso");if(t){var e={idunidad:r.Idunidad,idgrado:r.IdGrado,idcategoria:r.idcategoria};this._ServicioMensajeService.show(),this._DatospersonalesService.eliminarCuposAcensos(e).subscribe({next:c=>{this._ServicioMensajeService.hide(),c.error?this._DatospersonalesService.mensajeError(c.error):c.mensaje?this._DatospersonalesService.mensajeError(c.mensaje):(this._DatospersonalesService.mensajeBueno(c.resultado),this.refrescarCupos())},error:()=>{this._ServicioMensajeService.hide(),this._DatospersonalesService.mensajeError("ERROR DE CONEXION")}})}})}seleccionarTarjeta(r){this.tarjetaSelected=r}modificarCantidadCupos(r){if(r.valid){var t={cupos:r.value.cupos,idunidad:this.tarjetaSelected.Idunidad,idgrado:this.tarjetaSelected.IdGrado,idcategoria:this.tarjetaSelected.idcategoria};this._ServicioMensajeService.show(),this._DatospersonalesService.actualizarcuposAcensos(t).subscribe({next:e=>{this._ServicioMensajeService.hide(),e.error?this._DatospersonalesService.mensajeError(e.error):e.mensaje?this._DatospersonalesService.mensajeError(e.mensaje):(this._DatospersonalesService.mensajeBueno(e.resultado),this.refrescarCupos(),r.reset())},error:()=>{this._ServicioMensajeService.hide(),this._DatospersonalesService.mensajeError("ERROR DE CONEXION")}})}else this._DatospersonalesService.mensajeError("FORMULARIO INVALIDO")}};m.\u0275fac=function(t){return new(t||m)(M(W),M(N))},m.\u0275cmp=O({type:m,selectors:[["app-crear-cupos-ascensos"]],decls:33,vars:29,consts:[["FormularioCupos","ngForm"],["formulario","ngForm"],["forma","ngForm"],[1,"container","py-5"],[1,"container-fluid","py-4"],["header","Agregar ascenso",3,"visibleChange","visible","modal","draggable","resizable","closable"],["novalidate","",1,"row","g-3"],[1,"col-12"],[1,"form-label","fw-semibold","small","text-muted","mb-1"],["optionLabel","nombreGrado","name","idgradoControlSelected","placeholder","Seleccione una categor\xEDa","required","",1,"w-100",3,"ngModelChange","onChange","options","ngModel","filter"],["optionLabel","Grado","name","gradoSelected","placeholder","Seleccione un grado","required","",1,"w-100",3,"ngModelChange","options","ngModel","filter"],["pTemplate","item"],["name","fechaAscenso","dateFormat","yy-mm-dd","required","",1,"w-100",3,"ngModelChange","ngModel","showIcon","appendTo"],["type","number","name","cupos","min","1","required","",1,"form-control",3,"ngModelChange","ngModel"],[1,"col-12","mt-2"],["pButton","","type","button","label","Guardar","icon","pi pi-save",1,"p-button-primary","w-100",3,"click"],["header","Cambiar cupos de ascenso",3,"visibleChange","visible","modal","draggable","resizable","closable"],["name","cupos","type","number","required","","min","0",1,"form-control",3,"ngModelChange","ngModel"],["pButton","","type","button","label","Guardar cambios","icon","pi pi-save",1,"p-button-primary","w-100",3,"click"],[1,"row","justify-content-center"],[1,"col-lg-6","col-md-8"],[1,"card","shadow-lg","border-0","rounded-4"],[1,"card-header","bg-success","text-white","rounded-top-4","d-flex","justify-content-between","align-items-center"],[1,"card-title","mb-0"],[1,"fas","fa-user-shield","me-2"],[1,"card-body"],[1,"text-muted","mb-3"],["optionLabel","nombre","name","fuerzaSelected","placeholder","Seleccione una fuerza","required","",1,"w-100",3,"ngModelChange","onChange","options","ngModel","showClear","filter"],["optionLabel","unidad","name","unidadSelected","placeholder","Seleccione una unidad","required","",1,"w-100",3,"ngModelChange","options","ngModel","showClear","filter"],[1,"col-12","d-flex","justify-content-end","align-items-center","mt-3"],["pButton","","type","button","label","Siguiente","icon","pi pi-angle-double-right",1,"p-button-danger"],[1,"d-flex","align-items-center","gap-2"],["pButton","","type","button","label","Siguiente","icon","pi pi-angle-double-right",1,"p-button-danger",3,"click"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[1,"text-muted","small"],[1,"card","shadow","border-0","rounded-4"],["pButton","","type","button",1,"p-button-rounded","p-button-text","me-2",2,"background-color","white",3,"click","text","rounded","raised"],[1,"pi","pi-arrow-left"],[1,"mb-0"],["pButton","","type","button","icon","pi pi-plus","title","Agregar nuevo ascenso",1,"p-button-rounded","p-button-danger",3,"click"],[1,"container","py-3"],[1,"col-12","col-xl-10"],[1,"row","row-cols-1","row-cols-md-3","g-4"],[1,"col"],[1,"text-center","text-muted","py-4"],[1,"card","asc-card","h-100","shadow-lg","border-0","rounded-4","overflow-hidden"],[1,"asc-img-wrapper"],["src","cupoascenso.jpg","alt","Cupo ascenso",1,"asc-img"],[1,"asc-img-overlay"],[1,"badge","bg-warning","text-dark","shadow-sm","asc-badge"],[1,"pi","pi-star-fill","me-1"],[1,"card-body","px-4","py-3"],[1,"text-uppercase","text-muted","fw-bold","small","mb-3","d-flex","align-items-center","gap-2"],[1,"pi","pi-id-card","text-warning"],[1,"list-unstyled","asc-list"],[1,"card-footer","asc-footer","d-flex","justify-content-between","align-items-center"],["pButton","","type","button",1,"p-button-sm","p-button-rounded","p-button-warning",3,"click"],[1,"pi","pi-pencil"],["pButton","","type","button",1,"p-button-sm","p-button-rounded","p-button-danger","p-button-outlined",3,"click"],[1,"pi","pi-trash"],[1,"pi","pi-info-circle","mb-2",2,"font-size","2rem"]],template:function(t,e){if(t&1){let c=E();y(0,ue,31,9,"div",3),y(1,ge,19,5,"div",4),o(2,"p-dialog",5),f("visibleChange",function(s){return u(c),v(e.mostrarAgregarAscenso,s)||(e.mostrarAgregarAscenso=s),p(s)}),o(3,"form",6,0)(5,"div",7)(6,"label",8),n(7," Categor\xEDa "),i(),o(8,"p-select",9),f("ngModelChange",function(s){return u(c),v(e.idgradoControlSelected,s)||(e.idgradoControlSelected=s),p(s)}),h("onChange",function(){return u(c),p(e.sacarGrados())}),i()(),o(9,"div",7)(10,"label",8),n(11," Grado "),i(),o(12,"p-select",10),f("ngModelChange",function(s){return u(c),v(e.gradoSelected,s)||(e.gradoSelected=s),p(s)}),I(13,_e,1,2,"ng-template",11),i()(),o(14,"div",7)(15,"label",8),n(16," Fecha de ascenso "),i(),o(17,"p-datepicker",12),f("ngModelChange",function(s){return u(c),v(e.fechaAscenso,s)||(e.fechaAscenso=s),p(s)}),i()(),o(18,"div",7)(19,"label",8),n(20," Autorizar cupos "),i(),o(21,"input",13),f("ngModelChange",function(s){return u(c),v(e.cupos,s)||(e.cupos=s),p(s)}),i()(),o(22,"div",14)(23,"button",15),h("click",function(){u(c);let s=j(4);return e.guardarCupos(s),p(e.mostrarAgregarAscenso=!1)}),i()()()(),o(24,"p-dialog",16),f("visibleChange",function(s){return u(c),v(e.mostrarCambiarCupos,s)||(e.mostrarCambiarCupos=s),p(s)}),o(25,"form",6,1)(27,"div",7)(28,"label",8),n(29," # de cupos "),i(),o(30,"input",17),f("ngModelChange",function(s){return u(c),v(e.cuposEdit,s)||(e.cuposEdit=s),p(s)}),i()(),o(31,"div",7)(32,"button",18),h("click",function(){u(c);let s=j(26);return e.modificarCantidadCupos(s),p(e.mostrarCambiarCupos=!1)}),i()()()()}t&2&&(x(e.ventana===0?0:-1),d(),x(e.ventana===1?1:-1),d(),D(V(27,ae)),S("visible",e.mostrarAgregarAscenso),g("modal",!0)("draggable",!1)("resizable",!1)("closable",!0),d(6),g("options",e.arregloControlGrados),S("ngModel",e.idgradoControlSelected),g("filter",!0),d(4),g("options",e.arregloGrados),S("ngModel",e.gradoSelected),g("filter",!0),d(5),S("ngModel",e.fechaAscenso),g("showIcon",!0)("appendTo","body"),d(4),S("ngModel",e.cupos),d(3),D(V(28,se)),S("visible",e.mostrarCambiarCupos),g("modal",!0)("draggable",!1)("resizable",!1)("closable",!0),d(6),S("ngModel",e.cuposEdit))},dependencies:[G,Z,J,q,K,U,X,Y,Q,R,H,$,ie,re,B,ne,oe,te,ee,P,L],styles:[".asc-img-wrapper[_ngcontent-%COMP%]{position:relative;width:100%;height:250px;overflow:hidden;border-bottom:3px solid rgba(255,193,7,.4)}.asc-img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;object-position:center;transition:transform .6s ease}.asc-img-wrapper[_ngcontent-%COMP%]:hover   .asc-img[_ngcontent-%COMP%]{transform:scale(1.08)}"]});let l=m;return l})();export{Oe as CrearCuposAscensosComponent};
