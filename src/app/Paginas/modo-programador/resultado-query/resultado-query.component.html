<div class="card p-3">
    <div class="d-flex gap-2 align-items-center mb-2">
      <button class="btn btn-success btn-sm"
              (click)="exportarExcel()"
              [disabled]="rows.length === 0">
        Exportar Excel
      </button>

      <button class="btn btn-outline-secondary btn-sm"
              (click)="exportarCSV()"
              [disabled]="rows.length === 0">
        Exportar CSV
      </button>

      <div class="ms-auto small text-muted" *ngIf="rows.length">
        Filas: {{ rows.length }} | Columnas: {{ columns.length }}
      </div>
    </div>

    <div *ngIf="message && rows.length === 0" class="alert alert-info py-2 mb-0">
      {{ message }}
    </div>

    <div class="table-responsive" *ngIf="rows.length">
      <table class="table table-striped table-bordered table-sm align-middle">
        <thead>
          <tr>
            <th *ngFor="let c of columns">{{ c }}</th>
          </tr>
        </thead>

        <tbody>
          <tr *ngFor="let r of rows">
            <td *ngFor="let c of columns">{{ formatCell(r[c]) }}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

   